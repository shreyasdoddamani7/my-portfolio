<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>SHREYAS DODDAMANI | Infinity Engine V92</title>
    
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="apple-touch-icon" href="favicon.png">

    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* =========================================
           1. CORE ARCHITECTURE
           ========================================= */
        :root {
            /* V90 MIDNIGHT AURORA THEME */
            --theme-color: #e6e6e6; 
            --bg-color: #050507; 
            --center-color: #15151a;
            --cursor-size: 30px;
        }

        html {
            scroll-behavior: smooth;
            overflow-x: hidden;
            height: 100%;
        }

        body {
            margin: 0;
            min-height: 100vh;
            color: var(--theme-color); 
            font-family: 'Syne', sans-serif;
            overflow-x: hidden;
            
            /* Deep Vignette */
            background: radial-gradient(circle at 50% 40%, var(--center-color) 0%, var(--bg-color) 90%);
            background-attachment: fixed; 

            transition: background 0.8s ease,
                        color 0.8s cubic-bezier(0.16, 1, 0.3, 1), 
                        border-color 0.8s cubic-bezier(0.16, 1, 0.3, 1);
            user-select: text;
            -webkit-tap-highlight-color: transparent;
            cursor: auto;
        }

        /* =========================================
           2. CRITICAL CURSOR LOGIC
           ========================================= */
        body.infinity-active { cursor: none; }
        body.infinity-active * { cursor: none; }

        body.scrolled-past, 
        body.infinity-active.scrolled-past,
        body.infinity-active.scrolled-past * { 
            cursor: auto !important; 
        }

        /* FORCE POINTER ON INTERACTIVES */
        body.scrolled-past a, 
        body.scrolled-past .profile-menu-btn, 
        body.scrolled-past .menu-link, 
        body.scrolled-past .social-icon, 
        body.scrolled-past .video-card {
            cursor: pointer !important;
        }

        .custom-cursor {
            position: fixed; top: 0; left: 0; width: var(--cursor-size); height: var(--cursor-size);
            pointer-events: none; z-index: 9999; mix-blend-mode: normal;
            opacity: 0; transition: opacity 0.2s ease;
        }
        body.infinity-active:not(.scrolled-past) .custom-cursor { opacity: 1; }

        .cursor-bolt {
            width: 100%; height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23ffffff'%3E%3Cpath d='M13 2L3 14h9l-1 8 10-12h-9l1-8z'/%3E%3C/svg%3E");
            background-size: contain; background-repeat: no-repeat;
            filter: drop-shadow(0 0 6px var(--theme-color));
            opacity: 0.9;
        }

        /* =========================================
           3. INFINITY MODE STYLES
           ========================================= */
        body.infinity-active {
            transition: color 0s linear, border-color 0s linear !important;
        }

        body.infinity-active h1 {
            transition: color 0s linear;
            text-shadow: none !important;
        }

        body.infinity-active .gallery-title {
            transition: color 0s linear;
            text-shadow: none !important;
        }

        body.infinity-active .profile-menu-btn,
        body.infinity-active .video-card {
            transition: border-color 0s linear, transform 0.3s ease, box-shadow 0.3s ease !important;
        }

        body.infinity-active .social-icon, 
        body.infinity-active .menu-link {
            transition: color 0s linear, transform 0.3s ease, text-shadow 0.3s ease !important;
        }

        /* =========================================
           4. UI ANIMATIONS & HUD
           ========================================= */
        #flash-effect {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: white; z-index: 10000; pointer-events: none; opacity: 0;
        }
        .flashing { animation: flashAnim 0.5s ease-out forwards; }
        @keyframes flashAnim { 0% { opacity: 0; } 10% { opacity: 1; } 100% { opacity: 0; } }
        @keyframes revealUp { from { opacity: 0; transform: translateY(100px); } to { opacity: 1; transform: translateY(0); } }

        .sticky-hud {
            position: fixed; top: 0; left: 0; width: 100%;
            padding: 20px 40px; box-sizing: border-box;
            display: flex; justify-content: space-between; align-items: center;
            z-index: 100; pointer-events: none;
        }
        @media (max-width: 768px) { .sticky-hud { padding: 15px 20px; } }

        /* FIXED: SHREYAS D. BUTTON */
        .back-to-top {
            pointer-events: auto; 
            font-weight: 800; text-transform: uppercase;
            letter-spacing: 2px; opacity: 0; transform: translateY(-20px); 
            transition: all 0.4s ease; text-decoration: none; color: var(--theme-color);
            
            /* THE FIX IS HERE */
            cursor: pointer !important; 
            user-select: none !important;
        }
        .back-to-top.visible { opacity: 1; transform: translateY(0); }

        .profile-menu-btn {
            pointer-events: auto; width: 50px; height: 50px;
            border-radius: 50%; overflow: hidden; cursor: pointer !important;
            border: 2px solid var(--theme-color);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        @media (max-width: 768px) { .profile-menu-btn { width: 40px; height: 40px; } }
        .profile-menu-btn:hover { transform: scale(1.1); box-shadow: 0 0 30px var(--theme-color); }
        .profile-menu-btn img { width: 100%; height: 100%; object-fit: cover; }

        .portfolio-tag {
            position: absolute; top: 40px; left: 40px;
            font-weight: 800; font-size: 0.7rem; letter-spacing: 5px;
            text-transform: uppercase; opacity: 0.6; z-index: 10;
            user-select: none;
        }
        @media (max-width: 768px) { .portfolio-tag { display: none; } }

        .hud-instructions {
            position: absolute; top: 80%; right: 25px; 
            transform: translateY(-50%); display: flex; flex-direction: column; gap: 22px;
            border-right: 2px solid var(--theme-color); padding-right: 20px; text-align: right;
            z-index: 10; opacity: 0.8; transition: 0.5s ease; pointer-events: none;
            user-select: none !important; 
        }
        @media (max-width: 768px) {
            .hud-instructions {
                top: auto; bottom: 30px; left: 20px; right: auto;
                text-align: left; border-right: none; border-left: 2px solid var(--theme-color); padding-left: 15px;
            }
        }
        .inst-item { font-size: 0.8rem; letter-spacing: 2px; text-transform: uppercase; line-height: 1.4; font-weight: 700; user-select: none !important; }
        .inst-item b { color: #fff; display: block; margin-bottom: 4px; font-size: 1rem; font-weight: 800; }

        .menu-drawer {
            position: fixed; top: 80px; right: 40px; width: 280px;
            background: rgba(0,0,0,0.9); backdrop-filter: blur(20px);
            border: 1px solid var(--theme-color); border-radius: 10px;
            padding: 30px; display: flex; flex-direction: column; gap: 20px;
            z-index: 99; opacity: 0; pointer-events: none;
            transform: translateY(-20px) scale(0.95);
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .menu-drawer.open { opacity: 1; pointer-events: auto; transform: translateY(0) scale(1); }
        .menu-link { text-decoration: none; color: white; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; transition: 0.3s; cursor: pointer !important; }
        .menu-link:hover { color: var(--theme-color); padding-left: 10px; text-shadow: 0 0 10px var(--theme-color); }

        /* =========================================
           5. CONTENT SECTIONS
           ========================================= */
        #canvas-container {
            position: fixed; top: 18%; left: 0; width: 100vw; height: 100vh;
            z-index: 1; pointer-events: none; will-change: opacity, transform;
        }

        .header { height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; position: relative; z-index: 10; }

        h1 {
            margin-top: 60px; font-weight: 800; font-size: clamp(2rem, 8vw, 5rem); 
            letter-spacing: 1.5vw; text-transform: uppercase;
            color: var(--theme-color); text-shadow: none;
            transition: color 0.1s linear, text-shadow 0.3s ease;
            text-align: center; width: 100%; padding: 0 20px; box-sizing: border-box; opacity: 0;
            animation: revealUp 1.2s cubic-bezier(0.16, 1, 0.3, 1) 0.5s forwards;
            user-select: none !important; 
        }
        @media (max-width: 768px) {
            h1 { font-size: 2rem; letter-spacing: 2px; margin-top: 140px; line-height: 1.2; }
        }

        .section-container {
            position: relative; z-index: 20; min-height: 100vh;
            display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 150px 20px;
            background: transparent; 
        }

        .about-card {
            max-width: 800px; text-align: center; line-height: 2.4; font-size: 1.2rem; color: var(--theme-color); 
            background: rgba(0, 0, 0, 0.9); padding: 80px 60px;
            border: 1px solid var(--theme-color); backdrop-filter: blur(20px);
            box-shadow: 0 0 80px rgba(0,0,0,0.6); opacity: 0;
            transform: translateY(80px); transition: all 1s cubic-bezier(0.16, 1, 0.3, 1);
        }
        @media (max-width: 768px) { .about-card { padding: 40px 20px; font-size: 1rem; line-height: 1.6; } }
        .about-card.visible { opacity: 1; transform: translateY(0); }

        .gallery-title {
            font-size: clamp(1.5rem, 4vw, 3rem); font-weight: 800; letter-spacing: 15px; 
            text-transform: uppercase; margin-bottom: 50px; color: var(--theme-color); 
            opacity: 0; transform: translateY(30px); transition: 0.8s ease; text-align: center;
        }
        @media (max-width: 768px) { .gallery-title { letter-spacing: 4px; font-size: 1.5rem; } }
        .gallery-title.visible { opacity: 1; transform: translateY(0); }

        .gallery-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px; width: 100%; max-width: 1200px; perspective: 1000px;
        }

        .video-card {
            height: 220px; border: 1px solid var(--theme-color); border-radius: 4px; overflow: hidden;
            background: #000; opacity: 0; transform: translateY(50px); 
            transition: transform 0.5s ease, box-shadow 0.5s ease, border-color 0.8s ease; 
            display: block; cursor: pointer !important;
        }
        .video-card.visible { opacity: 1; transform: translateY(0); }
        .video-card:hover { 
            transform: rotateX(5deg) rotateY(-5deg) scale(1.05) translateY(-10px); 
            box-shadow: 0 0 50px var(--theme-color); 
            z-index: 5; 
        }
        .video-card img { width: 100%; height: 100%; object-fit: cover; filter: grayscale(1) brightness(0.7); transition: 0.5s ease; }
        .video-card:hover img { filter: grayscale(0) brightness(1.1); }

        .footer {
            background: rgba(0,0,0,0.95); padding: 100px 20px; display: flex; flex-direction: column; align-items: center; gap: 30px;
            position: relative; z-index: 30; border-top: 1px solid rgba(255,255,255,0.1);
        }
        .social-links { display: flex; gap: 40px; flex-wrap: wrap; justify-content: center; }
        .social-icon { 
            color: var(--theme-color); text-decoration: none; font-weight: 800; 
            font-size: 1.2rem; letter-spacing: 2px; transition: 0.3s ease; cursor: pointer !important;
        }
        .social-icon:hover { 
            color: #fff; 
            text-shadow: 0 0 25px var(--theme-color), 0 0 45px var(--theme-color); 
            transform: translateY(-5px);
        }
        .copyright { font-size: 0.9rem; opacity: 0.6; letter-spacing: 2px; }
    </style>
</head>
<body id="top">

    <div id="flash-effect"></div>
    <div class="custom-cursor"><div class="cursor-bolt"></div></div>

    <div class="sticky-hud">
        <a href="#top" class="back-to-top">SHREYAS D.</a>
        <div class="profile-menu-btn" onclick="toggleMenu()">
            <img src="me.jpg" onerror="this.src='https://placehold.co/100x100/1a1a1a/a020f0?text=ME'" alt="Profile">
        </div>
    </div>

    <div class="portfolio-tag">THE PORTFOLIO</div>

    <div class="menu-drawer" id="menuDrawer">
        <a class="menu-link" onclick="toggleMenu(); window.scrollTo(0,0);">Home</a>
        <a class="menu-link" href="#about" onclick="toggleMenu()">About</a>
        <a class="menu-link" href="#work" onclick="toggleMenu()">Work</a>
        <a class="menu-link" href="#contact" onclick="toggleMenu()">Contact</a>
    </div>

    <div id="canvas-container"></div>

    <div class="header">
        <h1>SHREYAS DODDAMANI</h1>
        <div class="hud-instructions" id="hud"></div>
    </div>

    <div class="section-container" id="about">
        <div class="about-card scroll-reveal">
            Hey! , I'm <strong>Shreyas Doddamani</strong>, a tech enthusiast pursuing my Bachelor of Computer Applications at <strong>KLE BCA College, Dharwad</strong>.
            <br><br>
            I have a foundational knowledge of <strong>C, Java, and Python</strong>, and am currently diving deep into <strong>Web Development</strong>. 
            I am driven by a passion for professional growth in the tech industry, constantly exploring new frontiers that spark my curiosity.
            <br><br>
            Outside of academics, I lead a <strong>YouTube channel</strong> with over 3.8k subscribers, where I translate my creativity into detailed anime edits.
        </div>
    </div>

    <div class="section-container" id="work">
        <h2 class="gallery-title scroll-reveal">SOME OF MY EDITS</h2>
        <div class="gallery-grid">
            <a href="https://youtu.be/w52vyHk8p8k" target="_blank" class="video-card scroll-reveal">
                <img src="edit1.jpg" onerror="this.src='https://placehold.co/600x400/1a1a1a/a020f0?text=Edit+1'">
            </a>
            <a href="https://youtu.be/cN22fXTyGI4" target="_blank" class="video-card scroll-reveal">
                <img src="edit2.jpg" onerror="this.src='https://placehold.co/600x400/1a1a1a/ff0000?text=Edit+2'">
            </a>
            <a href="https://youtu.be/xnTLzKKvElg" target="_blank" class="video-card scroll-reveal">
                <img src="edit3.jpg" onerror="this.src='https://placehold.co/600x400/1a1a1a/0088ff?text=Edit+3'">
            </a>
        </div>
    </div>

    <div class="footer" id="contact">
        <div class="social-links">
            <a class="social-icon" href="https://www.youtube.com/@Mellorine_Editz7" target="_blank">YOUTUBE</a>
            <a class="social-icon" href="#">LINKEDIN</a>
            <a class="social-icon" href="#">GITHUB</a>
        </div>
        <div class="copyright">Â© 2025 Shreyas Doddamani.</div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script>
        const cursor = document.querySelector('.custom-cursor');
        let mX = 0, mY = 0, cX = 0, cY = 0, lastXpct = 0.5;
        let isInfinity = false, isLocked = false, autoSpinValue = 0, rotY = 0, rotX = 0;
        let isScrollLocked = false;
        const isMobile = window.innerWidth < 768;

        const mouse3D = new THREE.Vector3();
        const vTemp1 = new THREE.Vector3();
        const vTemp2 = new THREE.Vector3();

        const handleInput = (x, y) => {
            if (isScrollLocked) return; 
            mX = x; mY = y;
            lastXpct = x / window.innerWidth;
            mouse3D.set((x / window.innerWidth) * 2 - 1, -(y / window.innerHeight) * 2 + 1, 0.5);
            rotY = (lastXpct - 0.5) * 1.5;
            rotX = (y / window.innerHeight - 0.5) * 1.5;
            syncEngine(lastXpct);
        };

        document.addEventListener('mousemove', (e) => {
            mX = e.clientX; mY = e.clientY; 
            handleInput(e.clientX, e.clientY);
        });
        
        document.addEventListener('touchmove', (e) => handleInput(e.touches[0].clientX, e.touches[0].clientY), { passive: true });

        function animateUI() {
            cX += (mX - cX) * 0.08; cY += (mY - cY) * 0.08;
            cursor.style.transform = `translate3d(${cX - 15}px, ${cY - 15}px, 0)`;
            requestAnimationFrame(animateUI);
        }
        animateUI();

        function toggleMenu() { document.getElementById('menuDrawer').classList.toggle('open'); }

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: !isMobile, alpha: true, powerPreference: "high-performance" });
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        
        const updateSceneSize = () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.position.z = window.innerWidth < 768 ? 12 : 7.5; 
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        };
        updateSceneSize();
        document.getElementById('canvas-container').appendChild(renderer.domElement);
        window.addEventListener('resize', updateSceneSize);

        function createGlowTexture() {
            const canvas = document.createElement('canvas'); canvas.width = 128; canvas.height = 128;
            const ctx = canvas.getContext('2d');
            const g = ctx.createRadialGradient(64, 64, 0, 64, 64, 64);
            g.addColorStop(0, 'white'); g.addColorStop(0.3, 'rgba(255,255,255,0.7)'); g.addColorStop(1, 'transparent');
            ctx.fillStyle = g; ctx.fillRect(0,0,128,128);
            return new THREE.CanvasTexture(canvas);
        }
        const glowMap = createGlowTexture();

        const wireSun = new THREE.Mesh(
            new THREE.IcosahedronGeometry(2.4, 2), 
            new THREE.MeshBasicMaterial({ color: 0xffffff, wireframe: true, transparent: true, opacity: 0.2 })
        );
        scene.add(wireSun);

        const sunGeo = new THREE.IcosahedronGeometry(2.4, 15);
        const sunMat = new THREE.PointsMaterial({ color: 0xffffff, size: isMobile ? 0.18 : 0.14, map: glowMap, transparent: true, opacity: 0, blending: THREE.AdditiveBlending, depthWrite: false });
        const sun = new THREE.Points(sunGeo, sunMat);
        scene.add(sun);

        const dustCount = isMobile ? 12000 : 28000; 
        const dustGeo = new THREE.BufferGeometry();
        const dustPos = new Float32Array(dustCount * 3), originalPos = new Float32Array(dustCount * 3);
        for (let i = 0; i < dustCount; i++) {
            const x=(Math.random()-0.5)*80, y=(Math.random()-0.5)*80, z=(Math.random()-0.5)*80;
            dustPos[i*3]=x; dustPos[i*3+1]=y; dustPos[i*3+2]=z; originalPos[i*3]=x; originalPos[i*3+1]=y; originalPos[i*3+2]=z;
        }
        dustGeo.setAttribute('position', new THREE.BufferAttribute(dustPos, 3));
        dustGeo.attributes.position.setUsage(THREE.DynamicDrawUsage);
        const dust = new THREE.Points(dustGeo, new THREE.PointsMaterial({ color: 0xffffff, size: isMobile ? 0.28 : 0.22, map: glowMap, transparent: true, opacity: 0, blending: THREE.AdditiveBlending }));
        scene.add(dust);

        // --- V90 MIDNIGHT AURORA SPECTRUM ---
        const spectrum = [
            new THREE.Color('#8ea1e6'), // Muted Sapphire
            new THREE.Color('#c98ec4'), // Dusty Orchid
            new THREE.Color('#8ec9b8'), // Deep Sea Teal
            new THREE.Color('#8ea1e6')  // Back to Sapphire
        ];
        const bgSpectrum = [
            new THREE.Color('#05070c'), 
            new THREE.Color('#0a0509'), 
            new THREE.Color('#050a09'), 
            new THREE.Color('#05070c')
        ];

        function updateHUD() {
            const hud = document.getElementById('hud');
            if(!isInfinity) {
                hud.innerHTML = `<div class="inst-item"><b>INFINITY</b> Double click for infinity mode.</div>`;
            } else {
                hud.innerHTML = `
                    <div class="inst-item"><b>SPECTRUM</b> Move cursor to change color.</div>
                    <div class="inst-item"><b>COMMAND</b> Click to lock color.</div>
                    <div class="inst-item"><b>SHIFT</b> Double click to transform.</div>`;
            }
        }
        updateHUD();

        function toggleInfinity() {
            if (window.getSelection) { window.getSelection().removeAllRanges(); }
            const flash = document.getElementById('flash-effect');
            flash.classList.add('flashing'); setTimeout(() => flash.classList.remove('flashing'), 500);

            isInfinity = !isInfinity; isLocked = false;
            document.body.classList.toggle('infinity-active');
            
            if(isInfinity) {
                // DIMMED SPHERE (V86 Level)
                dust.material.opacity = 0.30; sun.material.opacity = 0.45; wireSun.material.opacity = 0;
                syncEngine(lastXpct); 
            } else {
                dust.material.opacity = 0; sun.material.opacity = 0; wireSun.material.opacity = 0.2;
                document.documentElement.style.setProperty('--theme-color', '#e6e6e6');
                document.documentElement.style.setProperty('--bg-color', '#050507');
                document.documentElement.style.setProperty('--center-color', '#15151a');
            }
            updateHUD();
        }

        window.addEventListener('dblclick', (e) => {
            if(e.target.closest('.profile-menu-btn') || e.target.closest('.menu-link') || e.target.closest('a')) return;
            toggleInfinity();
        });

        function syncEngine(xPct) {
            if (!isInfinity || isLocked) return;
            const safePct = Math.min(Math.max(xPct, 0), 0.9999);
            const segment = safePct * (spectrum.length - 1);
            const index = Math.floor(segment);
            const innerPct = segment - index;
            vTemp1.set(0,0,0);
            let mainCol = new THREE.Color(); mainCol.lerpColors(spectrum[index], spectrum[index + 1], innerPct);
            let bgCol = new THREE.Color(); bgCol.lerpColors(bgSpectrum[index], bgSpectrum[index + 1], innerPct);
            
            sun.material.color.copy(mainCol); dust.material.color.copy(mainCol);
            
            document.documentElement.style.setProperty('--theme-color', `#${mainCol.getHexString()}`);
            document.documentElement.style.setProperty('--bg-color', `#${bgCol.getHexString()}`);
            
            let centerSpot = mainCol.clone().multiplyScalar(0.1); 
            document.documentElement.style.setProperty('--center-color', `#${centerSpot.getHexString()}`);
        }

        function animate() {
            requestAnimationFrame(animate);
            
            const canvasOpacity = parseFloat(document.getElementById('canvas-container').style.opacity);
            if (canvasOpacity < 0.05) return; 

            autoSpinValue += 0.0027; 
            wireSun.rotation.y = sun.rotation.y = autoSpinValue + (rotY * 1.2);
            wireSun.rotation.x = sun.rotation.x += ( (rotX * 1.2) - sun.rotation.x) * 0.022;

            if(isInfinity) {
                const pos = dust.geometry.attributes.position.array;
                vTemp1.copy(mouse3D).unproject(camera);
                vTemp2.copy(vTemp1).sub(camera.position).normalize();
                const dPl = -camera.position.z / vTemp2.z;
                vTemp1.copy(camera.position).add(vTemp2.multiplyScalar(dPl));
                
                for(let i=0; i<dustCount; i++) {
                    const ix=i*3, iy=ix+1, iz=ix+2;
                    const dx=pos[ix]-vTemp1.x, dy=pos[iy]-vTemp1.y, dz=pos[iz]-vTemp1.z;
                    const d=Math.sqrt(dx*dx+dy*dy+dz*dz);
                    if(d<5.5) { 
                        const f=(5.5-d)/5.5; 
                        pos[ix]+=dx*f*0.18; pos[iy]+=dy*f*0.18; pos[iz]+=dz*f*0.18; 
                    } else { 
                        pos[ix]+=(originalPos[ix]-pos[ix])*0.025; 
                        pos[iy]+=(originalPos[iy]-pos[iy])*0.025; 
                        pos[iz]+=(originalPos[iz]-pos[iz])*0.025; 
                    }
                }
                dust.geometry.attributes.position.needsUpdate = true;
                dust.rotation.y += 0.00022;
            }
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('scroll', () => {
            const v = window.scrollY, h = window.innerHeight;
            const c = document.getElementById('canvas-container');
            const body = document.body;
            
            const op = Math.max(0, 1 - (v / (h * 0.8)));
            c.style.opacity = op;
            c.style.transform = `translateY(${-v * 0.3}px)`;
            
            if (v > h * 0.8) {
                if(!body.classList.contains('scrolled-past')) body.classList.add('scrolled-past');
            } else {
                if(body.classList.contains('scrolled-past')) body.classList.remove('scrolled-past');
            }

            if (v > 50 && !isScrollLocked) { isScrollLocked = true; } 
            else if (v < 50 && isScrollLocked) { isScrollLocked = false; }

            document.querySelector('.back-to-top').classList.toggle('visible', v > 300);
            document.querySelectorAll('.scroll-reveal').forEach(el => { if (el.getBoundingClientRect().top < h * 0.85) el.classList.add('visible'); });
        });

        window.addEventListener('click', (e) => { 
            if (window.getSelection().toString().length > 0 || e.target.closest('.profile-menu-btn') || e.target.closest('a')) return;
            if(isInfinity) isLocked = !isLocked; 
        });
    </script>

</body>
</html>

